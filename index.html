<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Domain Template Viewer</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/js-yaml/4.1.0/js-yaml.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-typescript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-yaml.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #3b82f6;
            --primary-dark: #2563eb;
            --secondary: #8b5cf6;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b;
            --bg-tertiary: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --border: #475569;
            --code-bg: #1a1f36;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        header {
            text-align: center;
            margin-bottom: 3rem;
            padding: 2rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 1rem;
            backdrop-filter: blur(10px);
        }

        h1 {
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0.5rem;
        }

        .metadata {
            color: var(--text-secondary);
            margin-bottom: 1rem;
        }

        .file-selector {
            margin-bottom: 2rem;
            padding: 1rem;
            background: var(--bg-secondary);
            border-radius: 0.5rem;
            border: 1px solid var(--border);
        }

        .file-selector input {
            width: 100%;
            padding: 0.75rem;
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            border-radius: 0.5rem;
            color: var(--text-primary);
            font-size: 1rem;
        }

        .tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 2rem;
            border-bottom: 2px solid var(--border);
            overflow-x: auto;
            padding-bottom: 0;
        }

        .tab {
            padding: 0.75rem 1.5rem;
            background: transparent;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
            margin-bottom: -2px;
            white-space: nowrap;
        }

        .tab:hover {
            color: var(--text-primary);
            background: rgba(255, 255, 255, 0.05);
        }

        .tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
            background: rgba(59, 130, 246, 0.1);
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section {
            background: var(--bg-secondary);
            border-radius: 0.75rem;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border: 1px solid var(--border);
        }

        .section h2 {
            color: var(--primary);
            margin-bottom: 1rem;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .section h3 {
            color: var(--secondary);
            margin: 1.5rem 0 0.75rem;
            font-size: 1.2rem;
        }

        .icon {
            width: 24px;
            height: 24px;
            display: inline-block;
        }

        .folder-structure {
            font-family: 'Courier New', monospace;
            background: var(--code-bg);
            padding: 1.5rem;
            border-radius: 0.5rem;
            overflow-x: auto;
        }

        .folder-item {
            padding: 0.25rem 0;
            color: var(--text-secondary);
        }

        .folder-item.required {
            color: var(--text-primary);
            font-weight: 600;
        }

        .rule-list {
            list-style: none;
            padding: 0;
        }

        .rule-item {
            padding: 0.75rem;
            margin-bottom: 0.5rem;
            background: var(--bg-tertiary);
            border-radius: 0.5rem;
            border-left: 4px solid transparent;
            transition: all 0.3s ease;
        }

        .rule-item:hover {
            transform: translateX(5px);
        }

        .rule-item.allowed {
            border-left-color: var(--success);
        }

        .rule-item.forbidden {
            border-left-color: var(--danger);
        }

        .rule-item.should {
            border-left-color: var(--primary);
        }

        .rule-item.should-not {
            border-left-color: var(--warning);
        }

        .rule-item::before {
            margin-right: 0.5rem;
            font-weight: bold;
        }

        .rule-item.allowed::before {
            content: "‚úÖ";
        }

        .rule-item.forbidden::before {
            content: "‚ùå";
        }

        .rule-item.should::before {
            content: "‚úì";
            color: var(--primary);
        }

        .rule-item.should-not::before {
            content: "‚ö†";
            color: var(--warning);
        }

        .code-block {
            margin: 1rem 0;
            border-radius: 0.5rem;
            overflow: hidden;
        }

        .code-header {
            background: var(--bg-tertiary);
            padding: 0.5rem 1rem;
            color: var(--text-secondary);
            font-size: 0.9rem;
            font-family: monospace;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .copy-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 0.25rem 0.75rem;
            border-radius: 0.25rem;
            cursor: pointer;
            font-size: 0.85rem;
            transition: background 0.3s ease;
        }

        .copy-btn:hover {
            background: var(--primary-dark);
        }

        .copy-btn.copied {
            background: var(--success);
        }

        pre {
            margin: 0 !important;
            border-radius: 0 !important;
        }

        code {
            font-family: 'Fira Code', 'Courier New', monospace !important;
            font-size: 0.9rem !important;
        }

        .accordion {
            margin: 1rem 0;
        }

        .accordion-header {
            background: var(--bg-tertiary);
            padding: 1rem;
            cursor: pointer;
            border-radius: 0.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background 0.3s ease;
        }

        .accordion-header:hover {
            background: rgba(59, 130, 246, 0.1);
        }

        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .accordion.open .accordion-content {
            max-height: 2000px;
            padding: 1rem;
        }

        .accordion-icon {
            transition: transform 0.3s ease;
        }

        .accordion.open .accordion-icon {
            transform: rotate(90deg);
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }

        .card {
            background: var(--bg-tertiary);
            padding: 1rem;
            border-radius: 0.5rem;
            border: 1px solid var(--border);
        }

        .card h4 {
            color: var(--primary);
            margin-bottom: 0.5rem;
        }

        .badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-right: 0.5rem;
        }

        .badge.version {
            background: var(--primary);
            color: white;
        }

        .badge.date {
            background: var(--secondary);
            color: white;
        }

        .loading {
            text-align: center;
            padding: 3rem;
            font-size: 1.2rem;
            color: var(--text-secondary);
        }

        .error {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid var(--danger);
            color: var(--danger);
            padding: 1rem;
            border-radius: 0.5rem;
            margin: 1rem 0;
        }

        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }

            h1 {
                font-size: 2rem;
            }

            .tabs {
                flex-wrap: nowrap;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }

            .tab {
                padding: 0.5rem 1rem;
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üèóÔ∏è Domain Template Viewer</h1>
            <div class="metadata" id="metadata">
                <span class="badge version">Loading...</span>
            </div>
            <p style="color: var(--text-secondary); margin-top: 1rem;">
                Interactive viewer for Domain Layer Template YAML files
            </p>
        </header>

        <div class="file-selector">
            <input type="text" id="yamlFile" value="DOMAIN_TEMPLATE.yaml" placeholder="Enter YAML filename">
            <button onclick="loadYAML()" class="copy-btn" style="margin-top: 1rem;">Load Template</button>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="showTab('structure')">üìÅ Structure</button>
            <button class="tab" onclick="showTab('dependencies')">üîó Dependencies</button>
            <button class="tab" onclick="showTab('rules')">üìã Rules</button>
            <button class="tab" onclick="showTab('usecases')">‚öôÔ∏è Use Cases</button>
            <button class="tab" onclick="showTab('errors')">‚ö†Ô∏è Errors</button>
            <button class="tab" onclick="showTab('tests')">üß™ Test Helpers</button>
            <button class="tab" onclick="showTab('troubleshooting')">üîß Troubleshooting</button>
            <button class="tab" onclick="showTab('refactoring')">‚ôªÔ∏è Refactoring</button>
            <button class="tab" onclick="showTab('ai')">ü§ñ AI Guidelines</button>
        </div>

        <div id="content">
            <div class="loading">Loading template...</div>
        </div>
    </div>

    <script>
        let templateData = null;

        async function loadYAML() {
            const filename = document.getElementById('yamlFile').value;
            const contentDiv = document.getElementById('content');

            try {
                const response = await fetch(filename);
                if (!response.ok) throw new Error(`Failed to load ${filename}`);

                const yamlText = await response.text();
                templateData = jsyaml.load(yamlText);

                renderTemplate();
            } catch (error) {
                contentDiv.innerHTML = `<div class="error">Error loading template: ${error.message}</div>`;
            }
        }

        function renderTemplate() {
            if (!templateData) return;

            // Update metadata
            document.getElementById('metadata').innerHTML = `
                <span class="badge version">v${templateData.version}</span>
                <span class="badge date">${templateData.metadata.lastUpdated}</span>
            `;

            // Render content
            renderContent();
        }

        function renderContent() {
            const content = document.getElementById('content');
            content.innerHTML = `
                <div id="structure" class="tab-content active">${renderStructure()}</div>
                <div id="dependencies" class="tab-content">${renderDependencies()}</div>
                <div id="rules" class="tab-content">${renderRules()}</div>
                <div id="usecases" class="tab-content">${renderFeature('useCases')}</div>
                <div id="errors" class="tab-content">${renderFeature('errors')}</div>
                <div id="tests" class="tab-content">${renderFeature('testHelpers')}</div>
                <div id="troubleshooting" class="tab-content">${renderTroubleshooting()}</div>
                <div id="refactoring" class="tab-content">${renderRefactoring()}</div>
                <div id="ai" class="tab-content">${renderAIGuidelines()}</div>
            `;

            // Re-apply syntax highlighting
            Prism.highlightAll();
        }

        function renderStructure() {
            const structure = templateData.structure;
            return `
                <div class="section">
                    <h2>üìÅ Project Structure</h2>
                    <p style="color: var(--text-secondary); margin-bottom: 1rem;">
                        Base path: <code>${structure.basePath}</code>
                    </p>
                    <div class="folder-structure">
                        ${structure.folders.map(folder => `
                            <div class="folder-item ${folder.required ? 'required' : ''}">
                                ${folder.required ? 'üìÇ' : 'üìÅ'} ${folder.name}
                                <span style="color: var(--text-secondary); margin-left: 1rem;">
                                    // ${folder.description}
                                </span>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function renderDependencies() {
            const deps = templateData.layerDependencies;
            return `
                <div class="section">
                    <h2>üîó Layer Dependencies</h2>

                    <h3>‚úÖ Can Import from Domain</h3>
                    <ul class="rule-list">
                        ${deps.canImportFromDomain.map(item =>
                            `<li class="rule-item allowed">${item}</li>`
                        ).join('')}
                    </ul>

                    <h3>‚ùå Cannot Import from Domain</h3>
                    <ul class="rule-list">
                        ${deps.cannotImportFromDomain.map(item =>
                            `<li class="rule-item forbidden">${item}</li>`
                        ).join('')}
                    </ul>

                    <h3>üö´ Domain Cannot Import From</h3>
                    <ul class="rule-list">
                        ${deps.domainCannotImportFrom.map(item =>
                            `<li class="rule-item forbidden">${item}</li>`
                        ).join('')}
                    </ul>
                </div>
            `;
        }

        function renderRules() {
            const rules = templateData.domainRules;
            return `
                <div class="section">
                    <h2>üìã Domain Layer Rules</h2>

                    <h3>‚úÖ Allowed in Domain Layer</h3>
                    <ul class="rule-list">
                        ${rules.allowed.map(item =>
                            `<li class="rule-item allowed">${item}</li>`
                        ).join('')}
                    </ul>

                    <h3>‚ùå Forbidden in Domain Layer</h3>
                    <ul class="rule-list">
                        ${rules.forbidden.map(item =>
                            `<li class="rule-item forbidden">${item}</li>`
                        ).join('')}
                    </ul>
                </div>
            `;
        }

        function renderFeature(featureName) {
            const feature = templateData.features[featureName];
            const title = featureName === 'useCases' ? 'Use Cases' :
                          featureName === 'errors' ? 'Domain Errors' : 'Test Helpers';

            return `
                <div class="section">
                    <h2>${getFeatureIcon(featureName)} ${title}</h2>
                    <p style="color: var(--text-secondary); margin-bottom: 1rem;">
                        ${feature.purpose}
                    </p>

                    <div class="accordion">
                        <div class="accordion-header" onclick="toggleAccordion(this)">
                            <span>üìã Rules & Guidelines</span>
                            <span class="accordion-icon">‚ñ∂</span>
                        </div>
                        <div class="accordion-content">
                            <h3>Should:</h3>
                            <ul class="rule-list">
                                ${feature.rules.should.map(item =>
                                    `<li class="rule-item should">${item}</li>`
                                ).join('')}
                            </ul>

                            <h3>Should Not:</h3>
                            <ul class="rule-list">
                                ${feature.rules.shouldNot.map(item =>
                                    `<li class="rule-item should-not">${item}</li>`
                                ).join('')}
                            </ul>
                        </div>
                    </div>

                    <div class="accordion">
                        <div class="accordion-header" onclick="toggleAccordion(this)">
                            <span>üíª Template Code</span>
                            <span class="accordion-icon">‚ñ∂</span>
                        </div>
                        <div class="accordion-content">
                            <div class="code-block">
                                <div class="code-header">
                                    <span>TypeScript</span>
                                    <button class="copy-btn" onclick="copyCode(this, \`${feature.template.replace(/`/g, '\\`')}\`)">
                                        Copy
                                    </button>
                                </div>
                                <pre><code class="language-typescript">${escapeHtml(feature.template)}</code></pre>
                            </div>
                        </div>
                    </div>

                    <div class="accordion">
                        <div class="accordion-header" onclick="toggleAccordion(this)">
                            <span>üîß Validation Script</span>
                            <span class="accordion-icon">‚ñ∂</span>
                        </div>
                        <div class="accordion-content">
                            <div class="code-block">
                                <div class="code-header">
                                    <span>Bash</span>
                                    <button class="copy-btn" onclick="copyCode(this, \`${feature.validationScript.replace(/`/g, '\\`')}\`)">
                                        Copy
                                    </button>
                                </div>
                                <pre><code class="language-bash">${escapeHtml(feature.validationScript)}</code></pre>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderTroubleshooting() {
            const trouble = templateData.troubleshooting;
            return `
                <div class="section">
                    <h2>üîß Troubleshooting Guide</h2>

                    <div class="grid">
                        <div class="card">
                            <h4>üîç When Lint Fails</h4>
                            <ul style="list-style: none; padding: 0;">
                                ${trouble.lintFails.map(item =>
                                    `<li style="padding: 0.25rem 0;">‚ñ∏ ${item}</li>`
                                ).join('')}
                            </ul>
                        </div>

                        <div class="card">
                            <h4>üß™ When Tests Fail</h4>
                            <ul style="list-style: none; padding: 0;">
                                ${trouble.testsFail.map(item =>
                                    `<li style="padding: 0.25rem 0;">‚ñ∏ ${item}</li>`
                                ).join('')}
                            </ul>
                        </div>

                        <div class="card">
                            <h4>üìù When TypeScript Fails</h4>
                            <ul style="list-style: none; padding: 0;">
                                ${trouble.typeScriptFails.map(item =>
                                    `<li style="padding: 0.25rem 0;">‚ñ∏ ${item}</li>`
                                ).join('')}
                            </ul>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderRefactoring() {
            const refactor = templateData.refactoring;
            return `
                <div class="section">
                    <h2>‚ôªÔ∏è Refactoring Guide</h2>

                    <div class="accordion open">
                        <div class="accordion-header" onclick="toggleAccordion(this)">
                            <span>üìù Before Refactoring</span>
                            <span class="accordion-icon">‚ñ∂</span>
                        </div>
                        <div class="accordion-content">
                            <div class="code-block">
                                <div class="code-header">
                                    <span>Bash</span>
                                    <button class="copy-btn" onclick="copyCode(this, \`${refactor.beforeRefactoring.replace(/`/g, '\\`')}\`)">
                                        Copy
                                    </button>
                                </div>
                                <pre><code class="language-bash">${escapeHtml(refactor.beforeRefactoring)}</code></pre>
                            </div>
                        </div>
                    </div>

                    <div class="accordion">
                        <div class="accordion-header" onclick="toggleAccordion(this)">
                            <span>üîÑ During Refactoring</span>
                            <span class="accordion-icon">‚ñ∂</span>
                        </div>
                        <div class="accordion-content">
                            <div class="code-block">
                                <div class="code-header">
                                    <span>Bash</span>
                                    <button class="copy-btn" onclick="copyCode(this, \`${refactor.duringRefactoring.replace(/`/g, '\\`')}\`)">
                                        Copy
                                    </button>
                                </div>
                                <pre><code class="language-bash">${escapeHtml(refactor.duringRefactoring)}</code></pre>
                            </div>
                        </div>
                    </div>

                    <h3>Common Scenarios</h3>
                    ${refactor.commonScenarios.map(scenario => `
                        <div class="accordion">
                            <div class="accordion-header" onclick="toggleAccordion(this)">
                                <span>üìå ${scenario.name}</span>
                                <span class="accordion-icon">‚ñ∂</span>
                            </div>
                            <div class="accordion-content">
                                ${scenario.wrongExample ? `
                                    <h4 style="color: var(--danger);">‚ùå Wrong:</h4>
                                    <div class="code-block">
                                        <pre><code class="language-typescript">${escapeHtml(scenario.wrongExample)}</code></pre>
                                    </div>
                                ` : ''}
                                ${scenario.correctExample ? `
                                    <h4 style="color: var(--success);">‚úÖ Correct:</h4>
                                    <div class="code-block">
                                        <pre><code class="language-typescript">${escapeHtml(scenario.correctExample)}</code></pre>
                                    </div>
                                ` : ''}
                                ${scenario.script ? `
                                    <h4>üìú Script:</h4>
                                    <div class="code-block">
                                        <div class="code-header">
                                            <span>Bash</span>
                                            <button class="copy-btn" onclick="copyCode(this, \`${scenario.script.replace(/`/g, '\\`')}\`)">
                                                Copy
                                            </button>
                                        </div>
                                        <pre><code class="language-bash">${escapeHtml(scenario.script)}</code></pre>
                                    </div>
                                ` : ''}
                            </div>
                        </div>
                    `).join('')}

                    <h3>üö® Recovery Steps</h3>
                    <div class="grid">
                        <div class="card">
                            <h4>Accidental Commit</h4>
                            <div class="code-block">
                                <pre><code class="language-bash">${escapeHtml(templateData.recovery.accidentalCommit)}</code></pre>
                            </div>
                        </div>
                        <div class="card">
                            <h4>Domain Polluted</h4>
                            <div class="code-block">
                                <pre><code class="language-bash">${escapeHtml(templateData.recovery.domainPolluted)}</code></pre>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderAIGuidelines() {
            return `
                <div class="section">
                    <h2>ü§ñ AI Code Generation Guidelines</h2>
                    <p style="color: var(--text-secondary); margin-bottom: 1rem;">
                        Guidelines for AI assistants when generating code based on this template
                    </p>
                    <ul class="rule-list">
                        ${templateData.aiGuidelines.map((guideline, index) => `
                            <li class="rule-item should">
                                <strong>${index + 1}.</strong> ${guideline}
                            </li>
                        `).join('')}
                    </ul>
                </div>
            `;
        }

        function getFeatureIcon(featureName) {
            const icons = {
                'useCases': '‚öôÔ∏è',
                'errors': '‚ö†Ô∏è',
                'testHelpers': 'üß™'
            };
            return icons[featureName] || 'üìÑ';
        }

        function showTab(tabName) {
            // Update tab buttons
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');

            // Update content
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(tabName).classList.add('active');
        }

        function toggleAccordion(header) {
            const accordion = header.parentElement;
            accordion.classList.toggle('open');
        }

        function copyCode(button, code) {
            navigator.clipboard.writeText(code).then(() => {
                button.textContent = 'Copied!';
                button.classList.add('copied');
                setTimeout(() => {
                    button.textContent = 'Copy';
                    button.classList.remove('copied');
                }, 2000);
            });
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Load on page load
        window.addEventListener('DOMContentLoaded', () => {
            loadYAML();
        });
    </script>
</body>
</html>